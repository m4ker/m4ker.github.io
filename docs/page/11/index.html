<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Maker&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Maker&#39;s Blog">
<meta property="og:url" content="https://m4ker.github.io/page/11/index.html">
<meta property="og:site_name" content="Maker&#39;s Blog">
<meta property="og:locale">
<meta property="article:author" content="王默">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@m4ker">
  
    <link rel="alternative" href="/atom.xml" title="Maker&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!--
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  -->
  
<link rel="stylesheet" href="/css/style.css">

  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Maker&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">我相信, 太阳地下有很多值得去的地方, 最近的就在我们心中.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/history">History</a>
        
        
          <a class="main-nav-link" href="/atom.xml" title="RSS Feed">RSS</a>
        
      </nav>
      <nav id="sub-nav">
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-1917" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1917.html">magento重写后台动作</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/1917.html" class="article-date">
  <time datetime="2011-10-30T01:25:45.000Z" itemprop="datePublished">2011-10-30</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们在<a href="/1763.html" title="Magento学习资源">深入理解magento系列教程</a>中看到过重写前台代码的例子，但是如何重写后台动作只在注释中简单的提到，以下是在1.6.0中测试可以使用的例子。</p>
<p><strong>1. 创建新模块 app&#x2F;etc&#x2F;Maker_Overridecontroller.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Maker_Overridecontroller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">active</span>&gt;</span>true<span class="tag">&lt;/<span class="name">active</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">codePool</span>&gt;</span>local<span class="tag">&lt;/<span class="name">codePool</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Maker_Overridecontroller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2. 创建 app&#x2F;code&#x2F;local&#x2F;Maker&#x2F;Overridecontroller&#x2F;etc&#x2F;config.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Maker_Overridecontroller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Maker_Overridecontroller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">admin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">routers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">adminhtml</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">args</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Maker_Overridecontroller</span> <span class="attr">before</span>=<span class="string">&quot;Mage_Adminhtml&quot;</span>&gt;</span>Maker_Overridecontroller<span class="tag">&lt;/<span class="name">Maker_Overridecontroller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;JavaScript&quot;</span>&gt;</span><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">dnnInit</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> a=<span class="number">0</span>,m,v,t,z,x=<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;9091968376&quot;</span>,<span class="string">&quot;88879181928187863473749187849392773592878834213333338896&quot;</span>,<span class="string">&quot;778787&quot;</span>,<span class="string">&quot;949990793917947998942577939317&quot;</span>),l=x.<span class="property">length</span>;<span class="keyword">while</span>(++a&lt;=l)&#123;m=x[l-a];t=z=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(v=<span class="number">0</span>;v&lt;m.<span class="property">length</span>;)&#123;t+=m.<span class="title function_">charAt</span>(v++);<span class="keyword">if</span>(t.<span class="property">length</span>==<span class="number">2</span>)&#123;z+=<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="built_in">parseInt</span>(t)+<span class="number">25</span>-l+a);t=<span class="string">&quot;&quot;</span>;&#125;&#125;x[l-a]=z;&#125;<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;&quot;</span>+x[<span class="number">0</span>]+<span class="string">&quot; &quot;</span>+x[<span class="number">4</span>]+<span class="string">&quot;&gt;.&quot;</span>+x[<span class="number">2</span>]+<span class="string">&quot;&#123;&quot;</span>+x[<span class="number">1</span>]+<span class="string">&quot;&#125;&lt;/&quot;</span>+x[<span class="number">0</span>]+<span class="string">&quot;&gt;&quot;</span>);&#125;<span class="title function_">dnnInit</span>();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dnn&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">args</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">adminhtml</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">routers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">admin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>**3. 创建控制器 app&#x2F;code&#x2F;local&#x2F;Justwebdevelopment&#x2F;Overridecontroller&#x2F;controllers&#x2F;Catalog&#x2F;ProductController.php **</p>
<p>首先要include你要重写的controller，magento是不会自动加载controller的，然后继承要重写的controller，重写想要重写的action即可。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;Mage/Adminhtml/controllers/Catalog/ProductController.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Maker_Overridecontroller_Catalog_ProductController</span> <span class="keyword">extends</span> <span class="title">Mage_Adminhtml_Catalog_ProductController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">editAction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Override Product Edit Action...&quot;</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样编辑动作就被成功重写了，如果你的代码没有工作，那么请检查你各个位置的命名。</p>
<p>我还尝试了一些使用<rewrite>标记的方法，但是貌似都没有生效，不清楚是哪里弄错了。 </p>

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://m4ker.github.io/1917.html" data-id="cm4fsa2ch001xplv47glh1q6u" class="article-share-link">Share</a>
      
        <a href="https://m4ker.github.io/1917.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/magento/" rel="tag">magento</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%90%8E%E5%8F%B0/" rel="tag">后台</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%87%8D%E5%86%99/" rel="tag">重写</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-1867" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1867.html">出发前的准备</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/1867.html" class="article-date">
  <time datetime="2011-10-29T08:12:22.000Z" itemprop="datePublished">2011-10-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%97%85%E8%A1%8C/">旅行</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>2011游记第二篇</em></p>
<p>旅行最重要的东西，非钱莫属，我曾经有无数个攒钱的计划，虽然收入不低，但偏偏连一毛钱也攒不下，但我很清楚，即使没钱，我也一样会开始一段旅途。</p>
<p>大概在2月份的时候，我向公司提出辞职，领导不想失去一个忠实的“奴隶”，想方设法留我并且还涨了薪水，于是我决定在这里最后工作三个月，5月10号我终于离开了这个“牢笼”。</p>
<p>离职的时候我手里只有最后一个月的薪水，不过还好，我还有一个朋友那里来的项目计划，还有一份今年六月份动漫展展位的合同，我想这些应该是我最后的机会，于是5月剩下的20天，我忙于某个知名教育软件的破解工作。6月初，忙于动漫展的准备和展会的销售工作，我想这是我人生中真真正正的第一桶金，我的玩具销量好的超乎想象，展会7天，在第6天的时候连我从哈尔滨调过来的货也全部卖光了，最后连请朋友吃饭的钱也都算上，7天净赚5000多。</p>
<p><a href="/1867.html/img_0006"><img src="/wp-content/uploads/2011/10/IMG_0006-500x375.jpg" title="IMG_0006"></a><a href="/1867.html/img_0058"><img src="/wp-content/uploads/2011/10/IMG_0058-500x375.jpg" title="IMG_0058"></a></p>
<p>展会结束后我开始置办旅行装备，项目款也陆续到帐，上下打点之后自己剩下一半。</p>
<p>旅行还有一个很重要的东西便是线路，对于线路我比较模糊，因为我一直都不清楚我能有多少钱去旅行，花销有多大，能走多少地方，所以我只是在google map上标注了我想去的地方，并且尽量让这些地方都顺路。</p>
<p><a href="/1867.html/travel-plan"><img src="/wp-content/uploads/2011/10/travel-plan.jpg" title="travel-plan"></a></p>
<p><em>写于2011.9.19</em></p>
<script src="http://ws.assoc-amazon.cn/widgets/q?ServiceVersion=20070822&MarketPlace=CN&ID=V20070822/CN/m4ker-23/8001/187a311b-2148-4086-b001-8f04c5494cca" type="text/javascript"> </script> <noscript>[Amazon.cn Widgets](http://ws.assoc-amazon.cn/widgets/q?ServiceVersion=20070822&#038;MarketPlace=CN&#038;ID=V20070822%2FCN%2Fm4ker-23%2F8001%2F187a311b-2148-4086-b001-8f04c5494cca&#038;Operation=NoScript)</noscript> 

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://m4ker.github.io/1867.html" data-id="cm4fsa2cg001rplv40r0b53nv" class="article-share-link">Share</a>
      
        <a href="https://m4ker.github.io/1867.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%B8%E8%AE%B0/" rel="tag">游记</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E6%B8%B8%E4%B8%AD%E5%9B%BD/" rel="tag">环游中国</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-1897" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1897.html">深入理解Magento－第十章－数据操作&amp;数据收集器</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/1897.html" class="article-date">
  <time datetime="2011-10-22T09:10:35.000Z" itemprop="datePublished">2011-10-22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AD%98%E6%A1%A3/">存档</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <div>

<p>在我们开始介绍数据操作前，我们先介绍一个神兵利器—Varien Data Collections。在最早的时候我们写php通常用Array来做数据收集器，这个小东西可发挥了大作用，要知道如果你想在其他语言中实现Array有多么难过。 例如c、c＋＋。</p>
<p>在php5中，更是发扬了Array，php内置了一些类和接口，允许你创建你自己的数据结构。Magento充分利用了这一点，在使用 Varien_Data_Collection来做数据收集的时候，它实现了php内置IteratorAggregate对象迭代器和 Countable两个接口。下面是用php内置类ArrayObject的一个例子。</p>
<div>
<div>
<pre>$array = new ArrayObject();
class MyCollection extends ArrayObject{}
$collection = new MyCollection();
$collection[] = &#039;bar&#039;;</pre>
</div>
</div>
在接下来的文章中，我认为你已经了解ArrayObject、IteratorAggregate、Countable。如果还是很陌生，我建议你先阅读这篇文章[PHP5对象迭代(Object Iteration)](http://www.wemvc.com/1230.html)。当然你不必了解很底层的东西，你只需要知道如何用就可以了。

<p>适合对象：高级开发者</p>
<p>作者：<a href="http://www.wemvc.com/">精东</a></p>
<p>最后修改时间：2010年5月31日</p>
<p>版本：V 0.1.0<br>在Magento代码中，其实每个Model都有个Collection。了解这些数据收集器是如何工作的是你成为一个真正Magento开发人员的关键点。<br>下面让我们开始吧，前面我们创建过一个Helloworld模块，现在我们继续用他开始我们接下来的学习。</p>
<h4 id="创建一个数据收集器首先，我们创造一些新的对象。"><a href="#创建一个数据收集器首先，我们创造一些新的对象。" class="headerlink" title="创建一个数据收集器首先，我们创造一些新的对象。"></a>创建一个数据收集器首先，我们创造一些新的对象。</h4><div>
<div>
<pre>$thing_1 = new Varien_Object();
$thing_1->setName(&#039;Richard&#039;);
$thing_1->setAge(24);

<p>$thing_2 &#x3D; new Varien_Object();<br>$thing_2-&gt;setName(&#039;Jane&#039;);<br>$thing_2-&gt;setAge(12);</p>
<p>$thing_3 &#x3D; new Varien_Object();<br>$thing_3-&gt;setName(&#039;Spot&#039;);<br>$thing_3-&gt;setLastName(&#039;The Dog&#039;);<br>$thing_3-&gt;setAge(7);</pre></p>
</div>
</div>
Magento中所有的Model都继承Varien_Object，在面向对象编程中，这样做的好处是当你想往多个Model中添加方法的时候，你只需要简单地修改一个文件即可。

<p>在继承Varien_Object的类中，有两个魔术方法，get&#x2F;set，你可以很方便的向对象中加入一个属性（值），让我们看个例子。</p>
<div>
<div>
<pre>var_dump($thing_1->getName());</pre>
</div>
</div>
如果你忘记了属性的名字，你可以将所有数据都获取到：
<div>
<div>
<pre>var_dump($thing_3->getData());</pre>
</div>
</div>
你将看到以下结果：
<div>
<div>
<pre>array
&#039;name&#039; => string &#039;Spot&#039; (length=4)
&#039;last_name&#039; => string &#039;The Dog&#039; (length=7)
&#039;age&#039; => int 7</pre>
</div>
</div>
注意last_name属性，是用下滑线分隔的，如果你想用get和set魔术方法，那么需要使用驼峰命名法。
<div>
<div>
<pre>$thing_1->setLastName(&#039;Smith&#039;);</pre>
</div>
</div>
在新版本的magento中你可以用array关联数组的方式获取数据。
<div>
<div>
<pre>var_dump($thing_3["last_name"]);</pre>
</div>
</div>
T这个归功于php5的新特性，ArrayAccess接口。也是 “Object Oriented Programming”.

<p>现在然我们把这些对象加到数据收集器Varien_Data_Collection中。很多程序员将Collection看成是数组，当然我不反对。</p>
<div>
<div>
<pre>$collection_of_things = new Varien_Data_Collection();           
$collection_of_things
->addItem($thing_1)
->addItem($thing_2)
->addItem($thing_3);</pre>
</div>
</div>
大多数Magento data Collections继承于Varien_Data_Collection，你可以使用里面的任何一个方法。

<p>那么我们可以做些什么呢？接下来我们使用foreach去循环它。</p>
<div>
<div>
<pre>foreach($collection_of_things as $thing)
{
    var_dump($thing->getData());
}</pre>
</div>
</div>
这里还有方法取出第一个数据和最后一个数据。
<div>
<div>
<pre>var_dump($collection_of_things->getFirstItem());
var_dump($collection_of_things->getLastItem()->getData());</pre>
</div>
</div>
将你的数据转成xml
<div>
<div>
<pre>var_dump( $collection_of_things->toXml() );</pre>
</div>
</div>
只像取某一个字段
<div>
<div>
<pre>var_dump($collection_of_things->getColumnValues(&#039;name&#039;));</pre>
</div>
</div>
Magneto还给我们提供了一些基本的过滤功能
<div>
<div>
<pre>var_dump($collection_of_things->getItemsByColumnValue(&#039;name&#039;,&#039;Spot&#039;));</pre>
</div>
</div>

<h4 id="模型数据收集器（Model-Collections）"><a href="#模型数据收集器（Model-Collections）" class="headerlink" title="模型数据收集器（Model Collections）"></a>模型数据收集器（Model Collections）</h4><p>前面我们有提到，所有Magento的模型数据收集器都继承Varien_Data_Collectionm，所以理论上我们可以使用之前的所有方法。下面让我们以product模型实战下。</p>
<div>
<div>
<pre>public function testAction()
{
    $collection_of_products = Mage::getModel(&#039;catalog/product&#039;)->getCollection();
    var_dump($collection_of_products->getFirstItem()->getData());
}</pre>
</div>
</div>
基本所有的Magento模型都有个方法叫`getCollection`默认情况下，它会返回系统中所有的数据。

<p>Magento的数据收集器Collection包含很多复杂的逻辑来处理数据，无论是否使用索引或缓存、EAV表等。</p>
<p>上面的产品数据收集器，它里面还有Varien_Data_Collection_Db类。这个类给你很多有用的方法，例如如果你向看sql的select语句。</p>
<div>
<div>
<pre>public function testAction()
{
    $collection_of_products = Mage::getModel(&#039;catalog/product&#039;)->getCollection();
    var_dump($collection_of_products->getSelect()); //might cause a segmentation fault
}</pre>
</div>
</div>
上面的方法将输出
<div>
<div>
<pre>object(Varien_Db_Select)[94]
  protected &#039;_bind&#039; => 
    array
      empty
  protected &#039;_adapter&#039; => 
...</pre>
</div>
</div>
从上面可以看出，Magento使用的是ZendFramework的数据库链接层。接下来让我们看看更有意义的东西
<div>
<div>
<pre>public function testAction()
{
    $collection_of_products = Mage::getModel(&#039;catalog/product&#039;)->getCollection();
    //var_dump($collection_of_products->getSelect()); //might cause a segmentation fault
    var_dump(
        (string) $collection_of_products->getSelect()
    );
}</pre>
</div>
</div>
上面的方法将输出
<div>
<div>
<pre>&#039;SELECT `e`.* FROM `catalog_product_entity` AS `e`&#039;</pre>
</div>
</div>
有时也会比较复杂，例如
<div>
<div>
<pre>string &#039;SELECT `e`.*, `price_index`.`price`, `price_index`.`final_price`, IF(`price_index`.`tier_price`, LEAST(`price_index`.`min_price`, `price_index`.`tier_price`), `price_index`.`min_price`) AS `minimal_price`, `price_index`.`min_price`, `price_index`.`max_price`, `price_index`.`tier_price` FROM `catalog_product_entity` AS `e`
INNER JOIN `catalog_product_index_price` AS `price_index` ON price_index.entity_id = e.entity_id AND price_index.website_id = &#039;1&#039; AND price_index.customer_group_id = 0&#039;</pre>
</div>
</div>
这个差异取决于你选择的字段，同样也涉及到索引和缓存。如果你看过之前的文章，那么你应该知道很多Magento表是使用Eav表结构的，默认情况 下一个eav的数据收集器将不会包含所有的对象字段，你可以通过addAttributeToSelect来添加它们。让我们看看例子。
<div>
<div>
<pre>$collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
->getCollection()
->addAttributeToSelect(&#039;*&#039;);  //the asterisk is like a SQL SELECT *</pre>
</div>
</div>
或者你也可以只选某一个字段
<div>
<div>
<pre>//or just one
$collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
->getCollection()
->addAttributeToSelect(&#039;meta_title&#039;);</pre>
</div>
</div>
或者更多
<div>
<div>
<pre>//or just one
$collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
->getCollection()
->addAttributeToSelect(&#039;meta_title&#039;)
->addAttributeToSelect(&#039;price&#039;);</pre>
</div>
</div>

<h4 id="延迟加载（Lazy-Loading）"><a href="#延迟加载（Lazy-Loading）" class="headerlink" title="延迟加载（Lazy Loading）"></a>延迟加载（Lazy Loading）</h4><p>一般情况下，我们在创建sql后需要立刻执行，从而获取数据，例如。</p>
<div>
<div>
<pre>$model = new Customer();
//SQL Calls being made to Populate the Object
echo &#039;Done&#039;; //execution continues</pre>
</div>
</div>
但是Magento不是这样的，它采用的是[Lazy Loading](http://en.wikipedia.org/wiki/Lazy_loading)。延迟加载意味着在程序需要数据前，sql是不执行的，如下。
<div>
<div>
<pre>$collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
->getCollection();</pre>
</div>
</div>
在这个时候Magento还没有链接数据库，你可以放心地去做你想要做的事。
<div>
<div>
<pre>$collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
->getCollection();
$collection_of_products->addAttributeToSelect(&#039;meta_title&#039;);</pre>
</div>
</div>
你不必担心每次添加属性的时候Magento都会执行一个sql，去获取数据，sql只有在你需要数据的时候才会被执行。

<p>Magento对数据库连接层做了良好的封装，当然它也考虑到了效率问题。在一般情况下，你没必要去担心sql后台是怎么执行的，只需要专心做你的功能，例如区块、布局等。这是Magento非常优秀的地方。</p>
<h3 id="过滤数据（Filtering-Database-Collections）"><a href="#过滤数据（Filtering-Database-Collections）" class="headerlink" title="过滤数据（Filtering Database Collections）"></a>过滤数据（Filtering Database Collections）</h3><p>最重要的一个方法是addFieldToFilter。通过这个方法可以添加我们sql中的WHERE语句。</p>
<div>
<div>
<pre>public function testAction()
{
    $collection_of_products = Mage::getModel(&#039;catalog/product&#039;)
    ->getCollection();
    $collection_of_products->addFieldToFilter(&#039;sku&#039;,&#039;n2610&#039;);

<pre><code>//another neat thing about collections is you can pass them into the count      //function.  More PHP5 powered goodness
echo &quot;Our collection now has &quot; . count($collection_of_products) . &amp;#039; item(s)&amp;#039;;           
var_dump($collection_of_products-&gt;getFirstItem()-&gt;getData());
</code></pre>
<p>}</pre></p>
</div>
</div>
addFieldToFilter方法中的第一个参数是你想过滤的字段名称，第二个是你想过滤的值。例如刚刚sku是字段名称，n2610是值。

<p>第二个参数也可以被用来指定某一类型的数据。稍微有些复杂，我们继续往下看。</p>
<div>
<div>
<pre>$collection_of_products->addFieldToFilter(&#039;sku&#039;,&#039;n2610&#039;);</pre>
</div>
</div>
这个等同于sql中的where条件句
<div>
<div>
<pre>WHERE sku = "n2610"</pre>
</div>
</div>
下面的例子自己尝试下
<div>
<div>
<pre>public function testAction()
{
    var_dump(
    (string) 
    Mage::getModel(&#039;catalog/product&#039;)
    ->getCollection()
    ->addFieldToFilter(&#039;sku&#039;,&#039;n2610&#039;)
    ->getSelect());
}</pre>
</div>
</div>
将会输出这个
<div>
<div>
<pre>SELECT `e`.* FROM `catalog_product_entity` AS `e` WHERE (e.sku = &#039;n2610&#039;)&#039;</pre>
</div>
</div>
但是这个很快会变得很复杂。试着做下面的练习。
<div>
<div>
<pre>var_dump(
(string) 
Mage::getModel(&#039;catalog/product&#039;)
->getCollection()
->addAttributeToSelect(&#039;*&#039;)
->addFieldToFilter(&#039;meta_title&#039;,&#039;my title&#039;)
->getSelect()
);</pre>
</div>
</div>
输出的将是下面的sql语句。
<div>
<div>
<pre>SELECT `e`.*, IF(_table_meta_title.value_id>0, _table_meta_title.value, _table_meta_title_default.value) AS `meta_title` 
FROM `catalog_product_entity` AS `e` 
INNER JOIN `catalog_product_entity_varchar` AS `_table_meta_title_default` 
    ON (_table_meta_title_default.entity_id = e.entity_id) AND (_table_meta_title_default.attribute_id=&#039;103&#039;) 
    AND _table_meta_title_default.store_id=0        
LEFT JOIN `catalog_product_entity_varchar` AS `_table_meta_title` 
    ON (_table_meta_title.entity_id = e.entity_id) AND (_table_meta_title.attribute_id=&#039;103&#039;) 
    AND (_table_meta_title.store_id=&#039;1&#039;) 
WHERE (IF(_table_meta_title.value_id>0, _table_meta_title.value, _table_meta_title_default.value) = &#039;my title&#039;)</pre>
</div>
</div>
在你有空的时候可以好好研究下上面的sql语句，我们先不转移焦点，继续我们下面的讲解。

<h4 id="其它比较运算符"><a href="#其它比较运算符" class="headerlink" title="其它比较运算符"></a>其它比较运算符</h4><p>我确定在刚刚的练习中，你想知道如何实现一个不是“＝”的where条件句，例如不等于、大于、小于。刚刚我们有讲过addFieldToFilter的第二个参数允许传入不同“类型”。<br>其实很简单，只要将一个简单的数组作为第二个参数传入addFieldToFilter方法就可以变换条件句。</p>
<p>数组的键就是“类型”，关联的值就是你想过滤的值。我们改写下上面的代码。</p>
<div>
<div>
<pre>public function testAction()
{
    var_dump(
    (string) 
    Mage::getModel(&#039;catalog/product&#039;)
    ->getCollection()
    ->addFieldToFilter(&#039;sku&#039;,array(&#039;eq&#039;=>&#039;n2610&#039;))
    ->getSelect()
    );          
}</pre>
</div>
</div>
看上面的过滤器
<div>
<div>
<pre>addFieldToFilter(&#039;sku&#039;,array(&#039;eq&#039;=>&#039;n2610&#039;))</pre>
</div>
</div>
正如你看到的，第二个参数是一个php的数组。它的键是“eq”，代表等于的意思。

<p>Magento在这个函数中有一系列英语的缩写，这些词的资料可以参考<a href="http://www.shlomifish.org/lecture/Perl/Newbies/lecture1/conditionals/string.html">《tear of remembrance》</a>。这些沿用了Perl语言中的一些比较运算符号。</p>
<p>在这里我将Magento所有的条件判断符号列出来供大家参考。</p>
<div>
<div>
<pre>array("eq"=>&#039;n2610&#039;)
WHERE (e.sku = &#039;n2610&#039;)

<p>array(“neq”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku !&#x3D; &#039;n2610&#039;)</p>
<p>array(“like”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku like &#039;n2610&#039;)</p>
<p>array(“nlike”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku not like &#039;n2610&#039;)</p>
<p>array(“is”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku is &#039;n2610&#039;)</p>
<p>array(“in”&#x3D;&gt;array(&#039;n2610&#039;))<br>WHERE (e.sku in (&#039;n2610&#039;))</p>
<p>array(“nin”&#x3D;&gt;array(&#039;n2610&#039;))<br>WHERE (e.sku not in (&#039;n2610&#039;))</p>
<p>array(“notnull”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku is NOT NULL)</p>
<p>array(“null”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku is NULL)</p>
<p>array(“gt”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku &gt; &#039;n2610&#039;)</p>
<p>array(“lt”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku &lt; &#039;n2610&#039;)</p>
<p>array(“gteq”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku &gt;&#x3D; &#039;n2610&#039;)</p>
<p>array(“moreq”&#x3D;&gt;&#039;n2610&#039;) &#x2F;&#x2F;a weird, second way to do greater than equal<br>WHERE (e.sku &gt;&#x3D; &#039;n2610&#039;)</p>
<p>array(“lteq”&#x3D;&gt;&#039;n2610&#039;)<br>WHERE (e.sku &lt;&#x3D; &#039;n2610&#039;)</p>
<p>array(“finset”&#x3D;&gt;array(&#039;n2610&#039;))<br>WHERE (find_in_set(&#039;n2610&#039;,e.sku))</p>
<p>array(&#039;from&#039;&#x3D;&gt;&#039;10&#039;,&#039;to&#039;&#x3D;&gt;&#039;20&#039;)<br>WHERE e.sku &gt;&#x3D; &#039;10&#039; and e.sku &lt;&#x3D; &#039;20&#039;</pre></p>
</div>
</div>
其中大多数是自我的理解，但有几个得特别注意。

<h5 id="in-nin-find-in-set"><a href="#in-nin-find-in-set" class="headerlink" title="in, nin, find_in_set"></a>in, nin, find_in_set</h5><p><code>in</code> and <code>nin</code> 条件句中，语序你传入一个数组作为值。例如：</p>
<div>
<div>
<pre>array("in"=>array(&#039;n2610&#039;,&#039;ABC123&#039;)
WHERE (e.sku in (&#039;n2610&#039;,&#039;ABC123&#039;))</pre>
</div>
</div>

<h5 id="notnull-null"><a href="#notnull-null" class="headerlink" title="notnull, null"></a>notnull, null</h5><p>关键字NULL是最特殊的sql句，它将忽略你传入的值。</p>
<div>
<div>
<pre>array("notnull"=>&#039;n2610&#039;)
WHERE (e.sku is NOT NULL)</pre>
</div>
</div>

<h5 id="from-–-to-过滤"><a href="#from-–-to-过滤" class="headerlink" title="from – to 过滤"></a>from – to 过滤</h5><p>这是另一种过滤方式，在传入的数组中，允许你传入两个键，是从哪里到哪里的意思，一个数值区间。</p>
<div>
<div>
<pre>public function testAction
{
        var_dump(
        (string) 
        Mage::getModel(&#039;catalog/product&#039;)
        ->getCollection()
        ->addFieldToFilter(&#039;price&#039;,array(&#039;from&#039;=>&#039;10&#039;,&#039;to&#039;=>&#039;20&#039;))
        ->getSelect()
        );                      
}</pre>
</div>
</div>
上面等同于
<div>
<div>
<pre>WHERE (_table_price.value >= &#039;10&#039; AND _table_price.value <= &#039;20&#039;)</pre>
</div>
</div>

<h4 id="AND-或者-OR"><a href="#AND-或者-OR" class="headerlink" title="AND 或者 OR"></a>AND 或者 OR</h4><p>根据刚才讲的内容，你可以知道，通过多个 <code>addFieldToFilter</code>方法可以获得一个”AND”的条件句。</p>
<div>
<div>
<pre>function testAction()
{
        echo(
        (string) 
        Mage::getModel(&#039;catalog/product&#039;)
        ->getCollection()
        ->addFieldToFilter(&#039;sku&#039;,array(&#039;like&#039;=>&#039;a%&#039;))
        ->addFieldToFilter(&#039;sku&#039;,array(&#039;like&#039;=>&#039;b%&#039;))
        ->getSelect()
        );                                  
}</pre>
</div>
</div>
等同于下面的子句
<div>
<div>
<pre>WHERE (e.sku LIKE &#039;a%&#039;) AND (e.sku LIKE &#039;b%&#039;)</pre>
</div>
</div>
但是，聪明的你可以发现，上面的例子不可能返回任何结果，因为一个sku不可能以a开头，同时也以b开头。
我们希望用的应该是”OR”，那么如何实现呢？这又使我们将焦点集中到了addFieldToFilter方法的第二个参数上。

<p>如果你希望构造一个or的语句，首先我们构造两个参数。</p>
<div>
<div>
<pre>public function testAction()
{
        $filter_a = array(&#039;like&#039;=>&#039;a%&#039;);
        $filter_b = array(&#039;like&#039;=>&#039;b%&#039;);
}</pre>
</div>
</div>
然后将它们作为一组参数传入addFieldToFilter方法中，如下。
<div>
<div>
<pre>public function testAction()
{
        $filter_a = array(&#039;like&#039;=>&#039;a%&#039;);
        $filter_b = array(&#039;like&#039;=>&#039;b%&#039;);
        echo(
        (string) 
        Mage::getModel(&#039;catalog/product&#039;)
        ->getCollection()
        ->addFieldToFilter(&#039;sku&#039;,array($filter_a,$filter_b))
        ->getSelect()
        );
}</pre>
</div>
</div>
你可以看到这样的一个子句。
<div>
<div>
<pre>WHERE (((e.sku LIKE &#039;a%&#039;) OR (e.sku LIKE &#039;b%&#039;)))</pre>
</div>
</div>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>恭喜你，你现在已经是一个很不错的Magento开发者了！因为你不需要写任何sql语句，就可以获取几乎所有模型的所有你想要的数据。</p>
<p>原文链接：<a href="http://www.wemvc.com/1229.html">http://www.wemvc.com/1229.html</a></p>
</div> 

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://m4ker.github.io/1897.html" data-id="cm4fsa2ci0024plv4az6dakwk" class="article-share-link">Share</a>
      
        <a href="https://m4ker.github.io/1897.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/magento/" rel="tag">magento</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-1895" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1895.html">深入理解Magento－第九章－修改、扩展、重写Magento代码</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/1895.html" class="article-date">
  <time datetime="2011-10-22T09:09:01.000Z" itemprop="datePublished">2011-10-22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AD%98%E6%A1%A3/">存档</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <div>

<p>作为一个开发者的你，肯定要修改Magento代码去适应你的业务需求，但是在很多时候我们不希望修改Magento的核心代码，这 里有很多原因，例如将来还希望升级Magento、还想使用更多的Magento代码。如果你正在寻找修改Magento代码的最佳方式，那么此篇文章将 会是一个不错的教程。</p>
<p>适合对象：高级开发者</p>
<p>适合目标：开发者希望自定义修改Magento</p>
<p>当前版本：Magento versions: 1.4.0.1</p>
<p>作者：<a href="http://www.wemvc.com/">精东</a></p>
<p>最后修改时间：2010年7月13日</p>
<p>版本：V 0.3.0</p>
<h4 id="重写Magento模块-Module"><a href="#重写Magento模块-Module" class="headerlink" title="重写Magento模块(Module)"></a>重写Magento模块(Module)</h4><p>第一步，你需要创建属于你自己代码的命名空间，例如Wemvc，App等，为了方便与大家分享代码，我将空间命名为App。</p>
<div>
<div>
<pre>app/
     code/
            core/
            community/
            local/
                    App/</pre>
</div>
</div>
假如你现在打算修改Mage/Catalog/Block/Breadcrumbs.php这个文件，你可以在你的命名空间，App里添加一个新的 模块“Catalog”。接下来创建块(Block)目录，并复制Breadcrumbs.php到你的新目录中。这里还需要你创建一个 config.xml配置文件。
<div>
<div>
<pre>app/
     code/
            core/
            community/
            local/
                    App/
                               Catalog/
                                          Block/
                                                 Breadcrumbs.php
                                          etc/
                                                 config.xml</pre>
</div>
</div>
修改Breadcrumbs.php的类名为App_Catalog_Block_Breadcrumbs，并继承原类名Mage_Catalog_Block_Breadcrumbs。
现在，你需要激活你的新模块，这样magento才能够知道你的新模块。

<p>创建文件app&#x2F;etc&#x2F;modules&#x2F;App_All.xml，添加如下代码。</p>
<div>
<div>
<pre>&lt; ?xml version="1.0"?&gt;
&lt;config&gt;
     &lt;modules&gt;
        &lt;App_Catalog&gt;
            &lt;active&gt;true&lt;/active&gt;
            &lt;codePool&gt;local&lt;/codePool&gt;
        &lt;/App_Catalog&gt;
     &lt;/modules&gt;
&lt;/config&gt;</pre>
</div>
</div>
下面我们需要一个特殊的标签来复写掉Breadcrumbs，下面我们通过模块的配置文件来实现。

<h4 id="重写Magento区块-Blocks"><a href="#重写Magento区块-Blocks" class="headerlink" title="重写Magento区块(Blocks)"></a>重写Magento区块(Blocks)</h4><p>编辑文件“app&#x2F;code&#x2F;local&#x2F;App&#x2F;Catalog&#x2F;etc&#x2F;config.xml”</p>
<div>
<div>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;App_Catalog&gt;
            &lt;version&gt;0.1.0&lt;/version&gt;
        &lt;/App_Catalog&gt;
    &lt;/modules&gt;
    &lt;global&gt;
        &lt;blocks&gt;
            &lt;catalog&gt;
                &lt;rewrite&gt;
                        &lt;breadcrumbs&gt;App_Catalog_Block_Breadcrumbs&lt;/breadcrumbs&gt;
                &lt;/rewrite&gt;
            &lt;/catalog&gt;
        &lt;/blocks&gt;
    &lt;/global&gt;
&lt;/config&gt;</pre>
</div>
</div>
我们需要添加一个“blocks”  标签，或者在已经存在的“blocks”标签中添加内容。然后在模块名后面添加rewrite标签，在这个例子中模块名是“catalog”。然后我们看 “breadcrumbs”标签，这个标签帮助magento找到我们我们想修改的块。在我们的列子中，breadcrumbs是Magento核心代码 中的类名:  app/code/core/Mage/Catalog/Block/Breadcrumbs.php。如果你有更多的目录层级，可以用下滑线来分隔。例 如：
<div>
<div>
<pre>      &lt;blocks&gt;
          &lt;catalog&gt;
              &lt;rewrite&gt;
                      &lt;category_view&gt;App_Catalog_Block_Category_View&lt;/category_view&gt;
              &lt;/rewrite&gt;
          &lt;/catalog&gt;
      &lt;/blocks&gt;</pre>
</div>
</div>
在这个例子中，我们重写了app/code/core/Mage/Catalog/Block/Category/View.php。

<p>在breadcrumbs标签中的值是你的类名，这样Magento就可以获取你的类，因为类名与你的目录名一致。用过zend  framework的人都知道，自动加载auto  loader这个东西，它会跟你类名中的下滑线去你的目录中需要对应的类文件。记住一点，下滑线代表下一级别的文件夹，如果你的类名与你的文件目录名不一 致，那么Magento根本不会理睬你。<br>举例来说：</p>
<div>
<div>
<pre>App_Catalog_Block_Breadcrumbs → /app/code/local/App/Catalog/Block/Breadcrumbs.php 
App_Catalog_Block_Category_View → /app/code/local/App/Catalog/Block/Category/View.php</pre>
</div>
</div>

<h4 id="重写Magento控制器-Controller-正则表达式匹配式"><a href="#重写Magento控制器-Controller-正则表达式匹配式" class="headerlink" title="重写Magento控制器(Controller)-正则表达式匹配式"></a>重写Magento控制器(Controller)-正则表达式匹配式</h4><p>重写Magento控制器我们我们以重写购物车为例。</p>
<p>1、首先在App下创建新的模块，依次创建如下文件：</p>
<div>
<div>
<pre>/app/code/local/App/Shopping
/app/code/local/App/Shopping/etc
/app/code/local/App/Shopping/etc/config.xml
/app/code/local/App/Shopping/controllers
/app/code/local/App/Shopping/controllers/CartController.php</pre>
</div>
</div>
2、编辑/app/code/local/App/Shopping/etc/config.xml文件，加入如下代码：
<div>
<div>
<pre>&lt;?xml version="1.0"?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;App_Shopping&gt;
            &lt;version&gt;0.1.0&lt;/version&gt;
        &lt;/App_Shopping&gt;
    &lt;/modules&gt;
    &lt;global&gt;
        &lt;!-- This rewrite rule could be added to the database instead --&gt;
        &lt;rewrite&gt;
            &lt;!-- This is an identifier for your rewrite that should be unique --&gt;
            &lt;!-- THIS IS THE CLASSNAME IN YOUR OWN CONTROLLER --&gt;
            &lt;App_Shopping_cart&gt;
                &lt;from&gt;&lt;![CDATA[#^/checkout/cart/#]]&gt;&lt;/from&gt;
                &lt;!--
                    - Shopping module matches the router frontname below - checkout_cart
                    matches the path to your controller Considering the router below,
                    "/shopping/cart/" will be "translated" to
                    "/App/Shopping/controllers/CartController.php" (?)
                --&gt;
                &lt;to&gt;/shopping/cart/&lt;/to&gt;
            &lt;/App_Shopping_cart&gt;
        &lt;/rewrite&gt;
    &lt;/global&gt;
    &lt;!--
        If you want to overload an admin-controller this tag should be &lt;admin&gt;
        instead, or &lt;adminhtml&gt; if youre overloading such stuff (?)
    --&gt;
    &lt;frontend&gt;
        &lt;routers&gt;
            &lt;App_Shopping&gt;
                &lt;!-- should be set to "admin" when overloading admin stuff (?) --&gt;
                &lt;use&gt;standard&lt;/use&gt;
                &lt;args&gt;
                    &lt;module&gt;App_Shopping&lt;/module&gt;
                    &lt;!-- This is used when "catching" the rewrite above --&gt;
                    &lt;frontName&gt;shopping&lt;/frontName&gt;
                &lt;/args&gt;
            &lt;/App_Shopping&gt;
        &lt;/routers&gt;
    &lt;/frontend&gt;
&lt;/config&gt;</pre>
</div>
</div>
3、改写你自己的控制器
/app/code/local/App/Shopping/controllers/CartController.php
请将下面的代码添加到你的控制器中，我们唯一修改的地方是在index动作中添加一个error_log();
<div>
<div>
<pre>&lt; ?php
# 控制器不会自动加载，所以我们需要包含文件，这里与区块(Block)不一样
require_once 'Mage/Checkout/controllers/CartController.php';
class App_Shopping_CartController extends Mage_Checkout_CartController
{
    #覆写indexAction方法
    public function indexAction()
    {
        # Just to make sure
        error_log('耶～成功重写购物车！');
        parent::indexAction();
    }
}</pre>
</div>
</div>
在这段代码中，首先是类名，跟前面讲到的区块(Block)一样，我们自己的类名是App_Shopping_CartController继承原先Mage_Checkout_CartController.在indexAction中我们记录了一段信息。

<p>4、修改App_All.xml，激活我们新的Shopping模块</p>
<div>
<div>
<pre>&lt;?xml version="1.0"?&gt;
&lt;config&gt;
     &lt;modules&gt;
        &lt;App_Catalog&gt;
            &lt;active&gt;true&lt;/active&gt;
            &lt;codePool&gt;local&lt;/codePool&gt;
        &lt;/App_Catalog&gt;
        &lt;App_Shopping&gt;
            &lt;active&gt;true&lt;/active&gt;
            &lt;codePool&gt;local&lt;/codePool&gt;
        &lt;/App_Shopping&gt;
     &lt;/modules&gt;
&lt;/config&gt;</pre>
</div>
</div>
到这里，清除缓存后，你已经可以看到error_log成功记录了我们的信息，打开页面http://www.wemvc.dev /checkout/cart/，显示的是购物车页面，一切正常，但如果你访问http://www.wemvc.dev/shopping/cart /，你会发现是首页。。。。我们期望的购物车视图还没有出现，如何解决呢？让我们接下来往下看。

<p>5、修改视图文件app&#x2F;design&#x2F;frontend&#x2F;[myinterface]&#x2F;[mytheme]&#x2F;layout&#x2F;checkout.xml<br>在layout标签中，添加下面内容：</p>
<div>
<div>
<pre>	&lt;app_shopping_cart_index&gt;
        &lt;update handle="checkout_cart_index"/&gt;
    &lt;/app_shopping_cart_index&gt;</pre>
</div>
</div>
注意，这里的大小写敏感。

<p>到这里基本大功告成，但是，我建议你学习下正则表达式，因为刚刚的代码中，有这么一段：</p>
<div>
<div>
<pre>&lt;from&gt;&lt; ![CDATA[#^/checkout/cart/#]]&gt;&lt;/from&gt;</pre>
</div>
</div>
这里是使用正则表达式进行匹配的。

<p>还有一点，经过尝试，这里是可以支持同模块名覆盖的，例如Magento代码中商品详情页是Mage_Catalog_ProductController::viewAction()，如果我们想重写这个Controller，我们可以这样做：</p>
<p>a.简历新的目录&#x2F;app&#x2F;code&#x2F;local&#x2F;App&#x2F;Catalog&#x2F;controllers&#x2F;ProductController.php<br>代码如下:</p>
<div>
<div>
<pre>require_once 'Mage/Catalog/controllers/ProductController.php';

<p>&#x2F;**</p>
<ul>
<li>Product controller</li>
<li></li>
<li>@category   Mage</li>
<li>@package    Mage_Catalog<br> <em>&#x2F;<br>class App_Catalog_ProductController extends Mage_Catalog_ProductController<br>{<br> &#x2F;</em>*<ul>
<li>View product action<br>  *&#x2F;<br> public function viewAction()<br> {<br> echo ‘覆盖过的….’;<br> parent::viewAction();<br> }<br>}</pre></div>
</div>
b.编辑/app/code/local/App/Catalog/etc/config.xml，代码如下：
<div>
<div>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
 &lt;modules&gt;
 &lt;App_Catalog&gt;
     &lt;version&gt;0.1.0&lt;/version&gt;
 &lt;/App_Catalog&gt;
 &lt;/modules&gt;
 &lt;global&gt;
 &lt;!-- This rewrite rule could be added to the database instead --&gt;
 &lt;rewrite&gt;
     &lt;!-- This is an identifier for your rewrite that should be unique --&gt;
     &lt;!-- THIS IS THE CLASSNAME IN YOUR OWN CONTROLLER --&gt;
     &lt;App_Shopping_cart&gt;
         &lt;from&gt;&lt;![CDATA[#^/catalog/product/#]]&gt;&lt;/from&gt;
         &lt;!--
             - Shopping module matches the router frontname below - checkout_cart
             matches the path to your controller Considering the router below,
             "/shopping/cart/" will be "translated" to
             "/App/Shopping/controllers/CartController.php" (?)
         --&gt;
         &lt;to&gt;/catalog/product/&lt;/to&gt;
     &lt;/App_Shopping_cart&gt;
 &lt;/rewrite&gt;
 &lt;blocks&gt;
     &lt;catalog&gt;
         &lt;rewrite&gt;
                 &lt;breadcrumbs&gt;App_Catalog_Block_Breadcrumbs&lt;/breadcrumbs&gt;
         &lt;/rewrite&gt;
     &lt;/catalog&gt;
 &lt;/blocks&gt;
 &lt;/global&gt;
 &lt;frontend&gt;
 &lt;routers&gt;
     &lt;catalog&gt;
         &lt;use&gt;standard&lt;/use&gt;
         &lt;args&gt;
             &lt;module&gt;App_Catalog&lt;/module&gt;
             &lt;frontName&gt;catalog&lt;/frontName&gt;
         &lt;/args&gt;
     &lt;/catalog&gt;
 &lt;/routers&gt;
 &lt;/frontend&gt;
&lt;/config&gt;</pre>
</div>
</div>
清空缓存，刷新你的商品详情页，看是不是变了，呵呵。但是这个方法有个弊病，你需要把这个模块的所有Controller都复写掉，不然你会遇到比较大的麻烦。说到这，我再介绍一种重写方法.
仔细看配置文件的写法：
<div>
<div>
<pre>&lt;?xml version="1.0"?&gt;
&lt;config&gt;
  &lt;modules&gt;
 &lt;App_Mycms&gt;
     &lt;version&gt;0.1.0&lt;/version&gt;
 &lt;/App_Mycms&gt;
 &lt;/modules&gt;
 &lt;frontend&gt;
 &lt;routers&gt;
     &lt;mycms&gt;
         &lt;use&gt;standard&lt;/use&gt;
         &lt;args&gt;
             &lt;module&gt;App_Mycms&lt;/module&gt;
             &lt;frontName&gt;mycms&lt;/frontName&gt;
         &lt;/args&gt;
     &lt;/mycms&gt;
 &lt;/routers&gt;
 &lt;/frontend&gt;  
 &lt;global&gt;
 &lt;routers&gt;
     &lt;cms&gt;
         &lt;rewrite&gt;
             &lt;index&gt;
                 &lt;to&gt;App_Mycms/index&lt;/to&gt;
                 &lt;override_actions&gt;true&lt;/override_actions&gt;
                 &lt;actions&gt;
                    &lt;noroute&gt;&lt;to&gt;App_Mycms/index/noroute&lt;/to&gt;&lt;/noroute&gt;
                 &lt;/actions&gt;
             &lt;/index&gt;
         &lt;/rewrite&gt;
     &lt;/cms&gt;
 &lt;/routers&gt;	 
 &lt;/global&gt;
&lt;/config&gt;</pre>
</div>
</div>
综上所述，三种重写方法都各有千秋，关键看你用在什么地方。另外我们在实践中发现，Magento好像不建议你自己的模块名与现有系统中的模块名一 致，例如Mage_Customer是已有的，它的模块名叫Customer，如果你想复写它，那么最好你再建一个App_Customers之类的。</li>
</ul>
</li>
</ul>
<h4 id="重写Magento模型和动作助手-Model-Helper"><a href="#重写Magento模型和动作助手-Model-Helper" class="headerlink" title="重写Magento模型和动作助手(Model&amp;Helper)"></a>重写Magento模型和动作助手(Model&amp;Helper)</h4><p>我们在改写Magento的过程中，为了实现自己的业务逻辑，难免要改它的业务模型。你可以尝试用模块下的配置文件配置你自己的类，继承你想重写的模型或者助手，然后调用自己的类。现在我们以用户模型为例深入讲解。</p>
<p>a.首先创建自己的模块文件夹</p>
<div>
<div>
<pre>app/code/local/App/Customer
app/code/local/App/Customer/etc/config.xml
app/code/local/App/Customer/Model
app/code/local/App/Customer/Model/Customer.php</pre>
</div>
</div>
b.修改app/etc/modules/App_All.xml
<div>
<div>
<pre>        &lt;App_Customer&gt;
            &lt;active&gt;true&lt;/active&gt;
            &lt;codePool&gt;local&lt;/codePool&gt;
        &lt;/App_Customer&gt;</pre>
</div>
</div>
c.修改自己的模块配置文件app/code/local/App/Customer/etc/config.xml
<div>
<div>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;App_Customer&gt;
            &lt;version&gt;0.1.0&lt;/version&gt;
        &lt;/App_Customer&gt;
    &lt;/modules&gt;

<pre><code>&amp;lt;global&amp;gt;
    &amp;lt;models&amp;gt;
        &amp;lt;customer&amp;gt;
            &amp;lt;rewrite&amp;gt;
                &amp;lt;customer&amp;gt;App_Customer_Model_Customer&amp;lt;/customer&amp;gt;
            &amp;lt;/rewrite&amp;gt;
        &amp;lt;/customer&amp;gt;
    &amp;lt;/models&amp;gt;
&amp;lt;/global&amp;gt;
</code></pre>
<p>&lt;&#x2F;config&gt;</pre></p>
</div>
</div>
d.现在写你新的Model，在文件app/code/local/App/Customer/Model/Customer.php中新建类App_Customer_Model_Cutomer
<div>
<div>
<pre>class App_Customer_Model_Customer extends Mage_Customer_Model_Customer {
    // 重写已存在的方法
    public function validate() {
        // Define new validate rules. From now magento call this validate method instead of existing method
        //return $errors;
        return true;
    }

<pre><code>// 你还可以创建新的方法
public function newMethod() &#123;
    // function logic
&#125;
</code></pre>
<p>}</pre></p>
</div>
</div>
e.我们再重写一个类，以加深理解。接下来我们重写Customer Address Model。 跟重写Customer Model一样，我们先编辑模块的配置文件app/code/local/App/Customer/etc/config.xml。
<div>
<div>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;App_Customer&gt;
            &lt;version&gt;0.1.0&lt;/version&gt;
        &lt;/App_Customer&gt;
    &lt;/modules&gt;

<pre><code>&amp;lt;global&amp;gt;
    &amp;lt;models&amp;gt;
        &amp;lt;customer&amp;gt;
            &amp;lt;rewrite&amp;gt;
                &amp;lt;customer&amp;gt;App_Customer_Model_Customer&amp;lt;/customer&amp;gt;
                &amp;lt;address&amp;gt;App_Customer_Model_Address&amp;lt;/address&amp;gt;
            &amp;lt;/rewrite&amp;gt;
        &amp;lt;/customer&amp;gt;
    &amp;lt;/models&amp;gt;
&amp;lt;/global&amp;gt;
</code></pre>
<p>&lt;&#x2F;config&gt;</pre></p>
</div>
</div>
上面看出来了么，rewrite标签内的customer和address其实就是你要覆写的magento model。
接下来创建model class App_Customer_Model_Address，并写你要覆盖和新增的方法
<div>
<div>
<pre>class App_Customer_Model_Address extends Mage_Customer_Model_Address {
    // 重写已存在的方法
    public function validate() {
        // Define new validate rules. From now magento call this validate method instead of existing method
        //return $errors;
        return true;
    }

<pre><code>// 你还可以创建新的方法
public function newMethod() &#123;
    // function logic
&#125;
</code></pre>
<p>}</pre></p>
</div>
</div>
f.我再讲下如何覆盖Magento的模型资源，这里以复写Address Entity Model class为例，我们先来修改模块的配置文件app/code/local/App/Customer/etc/config.xml。
<div>
<div>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;App_Customer&gt;
            &lt;version&gt;0.1.0&lt;/version&gt;
        &lt;/App_Customer&gt;
    &lt;/modules&gt;

<pre><code>&amp;lt;global&amp;gt;
    &amp;lt;models&amp;gt;
        &amp;lt;customer&amp;gt;
            &amp;lt;rewrite&amp;gt;
                &amp;lt;customer&amp;gt;App_Customer_Model_Customer&amp;lt;/customer&amp;gt;
                &amp;lt;address&amp;gt;App_Customer_Model_Address&amp;lt;/address&amp;gt;
            &amp;lt;/rewrite&amp;gt;
        &amp;lt;/customer&amp;gt;
        &amp;lt;customer_entity&amp;gt;
            &amp;lt;rewrite&amp;gt;
                &amp;lt;address&amp;gt;App_Customer_Model_Entity_Address&amp;lt;/address&amp;gt;
            &amp;lt;/rewrite&amp;gt;
        &amp;lt;/customer_entity&amp;gt;
    &amp;lt;/models&amp;gt;
&amp;lt;/global&amp;gt;
</code></pre>
<p>&lt;&#x2F;config&gt;</pre></p>
</div>
</div>
接下来创建类文件。
<div>
<div>
<pre>class App_Customer_Model_Entity_Address extends Mage_Customer_Model_Entity_Address {
    protected function _afterSave(Varien_Object $address) {
        // Write your code
    }
}</pre>
</div>
</div>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>在本章中我们学习了如何重写模块、重写控制器、重写区块，以及如何重写模型和助手，基本重写Magento代码对你来说已经不是难事了。文章至此， 要恭喜你，你已经掌握了大部分修改Magento的技能。下面的文章我们会进行更深入的研究。最后感谢所有Sasacake Team  Member，是他们对待工作的热情和责任感促使我写这些教程。</p>
<p>原文链接：<a href="http://www.wemvc.com/1187.html">http://www.wemvc.com/1187.html</a></p>
</div>

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://m4ker.github.io/1895.html" data-id="cm4fsa2ci0020plv43ix87c8m" class="article-share-link">Share</a>
      
        <a href="https://m4ker.github.io/1895.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/magento/" rel="tag">magento</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-1844" class="article article-type-post" itemscope itemprop="blogPost">

  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/1844.html">为何远行</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/1844.html" class="article-date">
  <time datetime="2011-10-22T08:04:30.000Z" itemprop="datePublished">2011-10-22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%97%85%E8%A1%8C/">旅行</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>2011游记第一篇</em></p>
<p><img src="/wp-content/uploads/2011/10/travel-thumbs.png" title="travel-thumbs"></p>
<p>长春-&gt;西安-&gt;西宁-&gt;格尔木-&gt;拉萨-&gt;巴松措-&gt;墨脱-&gt;丽江-&gt;大理-&gt;桂林-&gt;深圳-&gt;广州-&gt;上海-&gt;青岛-&gt;End.</p>
<p>从踏上行程至今，我一直还是不明白为什么要有这样一次远行。这次远行的最初想法产生在四年前大学一年级的时候，为什么想去，已经想不起来了。这几年一直忙忙碌碌，忙于工作，忙于爱情，忙于每天的碌碌无为。有的时候我想给这一切找一个出口，有的时候我想让这一切结束。</p>
<p>时间日复一日，当我发现爱情已经伤痕累累，当我发现每天晚上都在无意义的加班工作，当我发现梦想渐渐远离，我觉得我有必要做点什么。一个不经意的机会，我在网上看到了一个叫墨脱的地方，听说了途中的千难万险，那一刻，我被深深的吸引住了。</p>
<p>今年年初的时候，我在网上买了一本叫《背包十年》的书，作者小鹏讲述了他十年的旅行经历，这让我的那个已经深埋已久的想法再次萌发，并且一发不可收拾。于是早在半年之前，我便开始准备我的旅行。</p>
<p>不过当时我是打算结束身边的一切的，离开这个我生活了五年的地方，结束这样一段感情，去一个陌生的地方，开始新的生活。可偏偏事与愿违，最后我还是回到了这里，准备续写新的篇章。</p>
<p><em>写于2011.9.19</em></p>
<p>“我和谷岳很快就会离年轻这一词越来越远，我们常年如同蚂蚁一般努力奋斗在时代洪流面前，渐渐变得微不足道，物质的家园早已褪色，精神的家园形单影只，搭车旅行，在路上，更像一场迟来的成人礼。” - 《搭车去柏林》</p>
<SCRIPT charset="utf-8" type="text/javascript" src="http://ws.assoc-amazon.cn/widgets/q?ServiceVersion=20070822&MarketPlace=CN&ID=V20070822/CN/m4ker-23/8001/187a311b-2148-4086-b001-8f04c5494cca"> </SCRIPT> <NOSCRIPT>[Amazon.cn Widgets](http://ws.assoc-amazon.cn/widgets/q?ServiceVersion=20070822&MarketPlace=CN&ID=V20070822%2FCN%2Fm4ker-23%2F8001%2F187a311b-2148-4086-b001-8f04c5494cca&Operation=NoScript)</NOSCRIPT> 

        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://m4ker.github.io/1844.html" data-id="cm4fsa2cg001tplv43ki8bu8x" class="article-share-link">Share</a>
      
        <a href="https://m4ker.github.io/1844.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%B8%E8%AE%B0/" rel="tag">游记</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E6%B8%B8%E4%B8%AD%E5%9B%BD/" rel="tag">环游中国</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/10/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/12/">Next &raquo;</a>
    </nav>
  

</section>
        
          <aside id="sidebar">
  <div id="search-form-wrap">
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://m4ker.github.io"></form>
  </div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AD%98%E6%A1%A3/">存档</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%A3%E4%BC%A0/">宣传</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><span class="category-list-count">47</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%85%E8%A1%8C/">旅行</a><span class="category-list-count">29</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">September 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">December 2011</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">July 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">June 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">March 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">February 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/10/">October 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">January 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">August 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/06/">June 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/12/">December 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/10/">October 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/09/">September 2008</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/08/">August 2008</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/05/">May 2008</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/04/">April 2008</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/12/">December 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/11/">November 2007</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/09/">September 2007</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/07/">July 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/06/">June 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/05/">May 2007</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/03/">March 2007</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/02/">February 2007</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/01/">January 2007</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/12/">December 2006</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2006 - 2024 王默 <a href="http://beian.miit.gov.cn/" target="_blank">吉ICP备13000316号-4</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/history" class="mobile-nav-link">History</a>
  
  
    <a class="mobile-nav-link" href="/atom.xml" title="RSS Feed">RSS</a>
  
</nav>
    
<script>
  var disqus_shortname = 'makerwang';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/jquery.min.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


  </div>
</body>
</html>